@using System.Globalization
@using TrueSnow.Data.Models
@model TrueSnow.Web.Models.Posts.PostViewModel

@{
    Layout = null;
}

<div class="modal-header" style="background-color: #4C90B7;">
    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
    <h4 class="modal-title" id="postInfoModalLabel" style="text-align: center; color: white">@Model.Title</h4>
</div>
<div class="modal-body" style="padding: 0; margin-top: -1px;">
    <img src="~/File/@Model.Photo.Id" alt="photo" class="img-responsive" />
    <p>@Model.Content</p>
    <b>@Model.Creator.FirstName @Model.Creator.LastName</b>
    <p>@Model.CreatedOn.ToString("dd MMM HH:mm", CultureInfo.CreateSpecificCulture("en-US"))</p>
    <p id="likesCount-@Model.Id">Likes: @Model.Likes</p>

    @if (this.Request.IsAuthenticated)
    {
        <button class="btn btn-primary" data-toggle="modal" data-target="#addCommentModal"><span class="glyphicon glyphicon-pencil" aria-hidden="true"></span> <b>Comment</b></button>
        <span data-toggle="tooltip" data-placement="top" title="Like" data-original-title="Like" data-id="@Model.Id" data-action="like" class="glyphicon glyphicon-heart" style="font-size: 35px;"></span>
        <span data-toggle="tooltip" data-placement="top" title="Unlike" data-original-title="Unlike" data-id="@Model.Id" data-action="unlike" class="glyphicon glyphicon-heart-empty" style="font-size: 35px;"></span>
    }
    <hr />
</div>

@section scripts {
    <script>
        $('span[data-action="like"]').click(function () {
            var id = $(this).attr('data-id');

            $.post(
                '/Likes/Like',
                {
                    postId: id
                },
                function (data) {
                    $('#likesCount-' + id).html('Likes: ' + data.Count);
                });
        });

        $('span[data-action="unlike"]').click(function () {
            var id = $(this).attr('data-id');

            $.post(
                '/Likes/Unlike',
                {
                    postId: id
                },
                function (data) {
                    $('#likesCount-'+ id).html('Likes: ' + data.Count);
                });
        });
    </script>
}